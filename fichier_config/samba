# SERVEUR SAMBA
# /etc/samba/smb.conf

[global]

# Définit le nom du groupe de travail. Les clients Windows doivent tous être membres de ce groupe de travail.
workgroup = WORKGROUP

# Défini le nom qui apparaîtra dans le Voisinage Réseau de Windows. On utilisera le nom d'hôte du serveur.
netbios name = HECTOR

# Indique le nom avec lequel le serveur s'indentifie.
server string = Serveur de fichiers HECTOR

# Utilise un DNS proxy
dns proxy = yes

# Désigne un serveur Samba maître pour le domain local. On utilisera "yes" sur le serveur principal et "no" sur les autres serveurs.
domain master = yes

# Définit la journalisation. Pour chaque client qui utilise Samba, un fichier journal "log.client" est créé. Quant aux deux services Samba "smbd etnmbd", ils utilisent des événements globaux dans deux fichiers "/var/log/samba/log.smbd et log.nmbd". Ni le nom et l'emplacement de ces fichiers peuvent être modifié.
log file = /var/log/samba/log.%m

# Limite la taille maximale d'un fichier journal à  1000 KiloOctets.
max log size = 1000

# Signifie que seuls les messages d'erreur sont journalisés dans "/var/log/syslog". Pour obtenir une journalisation plus "bavarde", on remplacera la valeur 0 par 1, 2 , 3, etc...
syslog = 0

# Active les réglages par "interface"
bind interfaces only = yes
# Définit les interfaces réseau par lesquelles Samba est censé communiquer. On veillera à faire apparaître uniquement les partages dans le réseau local. NE PAS OUBLIER "localhost", faute de quoi les outils d'administation comme "smbclient" ne fonctionneront pas sur le serveur.
interfaces = 192.168.3.0/24 localhost

# Permet d'autoriser l'accès de certaines machines du réseau à Samba. Hosts deny fait l'inverse, il refuse l'accès à certaines machines à Samba.
hosts allow = 192.168.2. 127.
# hosts deny = @ip

# Définit le modèle de sécurité. Elle est optionelle, étant donné qu'il s'agit du réglage par défaut de Samba.
security = users

# Définit la gestion des mots de passe. "TDB" signifie "Trivial Database" et désigne un format de stockage binaire. Les mots de passes sont stockés dans le fichiher "/etc/samba/private/passdb.tdb"
passdb backend = tdbsam

# Désactive la synchronisation des mots de passe Samba avec les mots de passe Linux. Celle-ci est liée à toute une série de restrictions qui risquent de poser des problèmes. Il vaut mieux ne pas l'utiliser
unix password sync = no

# Définit les utilisateurs qui ne peuvent pas se connecter à Samba
invalid users = root

# Encrypte les mots de passes
encrypt passwords = yes

# Désigne l'utilisateurs Linux auquel on fait correspondre les utilisateurs invités.
guest account = smbguest

# Renvoie vers le compte invité toute tentative de connexion avec un identifiant inexistant.
map to guest = bad user

# Attribue tous les fichiers et répertoires nouvellement créés au groupe "user"
force group = users

# Donne les permissions -rw-rw---- (Lecture-Ecriture) aux fichiers créés par un membre du groupe. Ainsi il sera accessible aux autres membres du groupe. 
create mode = 0660
# Donne les permissions -rwxrwx--- (Lecture-Ecriture-Excution) aux fichiers créés par un membre du groupe. Ainsi il sera accessible aux autres membres du groupe. 
directory mode = 0770


# Nom du partage "Public" (ne doit pas dépasser 12 caractères)
[public]

# Chemin absolu du répertoire "Public"
path = /srv/samba/public
# Commentaire du répertoire "Public"
comment = Partage public

# Définit l'accès public
public = yes

# Donne accès aux invités
guest ok = yes

# Autorise l'écriture
read only = no


# Nom du partage "Confidentiel" (ne doit pas dépasser 12 caractères)
[confidentiel]

# Chemin absolu du répertoire "Confidentiel"
path = /srv/samba/confidentiel
# Commentaire du répertoire "Confidentiel"
comment = Partage confidentiel

# Autorise l'écriture
read only = no

# Définit les utilisateurs qui ne peuvent pas se connecter au répertoire.
invalid users = root nobody smbguest
